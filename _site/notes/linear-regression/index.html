<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-12-18">

<title>Phil in the Blank - Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../photos/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Phil in the Blank - Linear Regression">
<meta name="twitter:description" content="Linear regression models the relationship between some outcome variable \(Y_i\) based on a set of predictors \(X_{ji}\) where \(i\) indexes an individual case (e.g.">
<meta name="twitter:creator" content="@NguyenHPhil">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Linear Regression</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Phil in the Blank</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../poems.html" class="sidebar-item-text sidebar-link">Poems</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects.html" class="sidebar-item-text sidebar-link">Projects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes.html" class="sidebar-item-text sidebar-link">Notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Linear Regression</h1>
  <div class="quarto-categories">
    <div class="quarto-category">statistics</div>
    <div class="quarto-category">notes</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 18, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="main" class="level1">
<h1>Main</h1>
<p>Linear regression models the relationship between some outcome variable <span class="math inline">\(Y_i\)</span> based on a set of predictors <span class="math inline">\(X_{ji}\)</span> where <span class="math inline">\(i\)</span> indexes an individual case (e.g.&nbsp;a study subject) and <span class="math inline">\(j \in \{1,2,..., p \}\)</span> given <span class="math inline">\(p\)</span> predictors. This yields the equation</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_{1i} + ... + \beta_p X_{pi} + \epsilon_i
\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\)</span> is an error term for a particular case <span class="math inline">\(i\)</span>. The error terms model the variance left unexplained by the model and are called <em>residuals</em>. The goal is to estimate the beta terms in order to find a best fitting line.</p>
<p>The best fitting line is defined in many ways, but the most common involves minimizing the <em>least square criterion</em>. Minimizing the <strong>least squares criterion</strong> yields the beta values that minimize the ==residual sum of squares==, i.e.&nbsp;<span class="math display">\[\text{RSS}=e_{1}^{2} + e_{2}^{2} + ... + e_{n}^{2}\]</span> where <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span> is the <span class="math inline">\(i\)</span>th residual. Minimizing the residual sum of squares is equivalent to maximizing the variance that the model explains.</p>
<p>In the end what we have is the <em>estimated population regression line</em>, which predicts the average value of <span class="math inline">\(Y\)</span> given a particular value of <span class="math inline">\(X\)</span>. For example, if we have a regression equation <span class="math display">\[{\text{weight}} = \beta_0 + \beta_1 \text{height}\]</span>and we are given <span class="math inline">\(\beta_0, \beta_1\)</span>, and <span class="math inline">\(\text{height}=50\)</span> inches, we can plug those values in and get the <strong>average weight</strong> of a person who is 50 inches tall.</p>
</section>
<section id="assumptions" class="level1">
<h1>Assumptions</h1>
<p>Most of the assumptions revolve around the residuals. Namely that:</p>
<ol type="1">
<li>The residuals are normally distributed (<em>Normality assumption</em>) with a mean of <span class="math inline">\(0\)</span> and standard deviation of <span class="math inline">\(\sigma\)</span> (<em>Homoscedasticity assumption</em>), i.e.&nbsp;<span class="math inline">\(\epsilon_i \sim \text{Normal}(0, \sigma^2)\)</span>.</li>
<li>The residuals should be independent, which is typically a function of good study design.</li>
</ol>
<p><em>Linearity</em>:</p>
<blockquote class="blockquote">
<p>The conditional mean of the errors is assumed to be zero for any given combination of values of the predictor variables. This implies that, for standard multiple regression models, the relationship between every independent variable <span class="math inline">\(X_i\)</span> and the population mean of the dependent variable <span class="math inline">\(Y\)</span>, denoted by <span class="math inline">\(\mu_y\)</span>, is assumed to be linear when the other variables are held constant. Furthermore, the relations between the various <span class="math inline">\(X_i\)</span> and <span class="math inline">\(\mu_y\)</span> are additive: thus, the relation of <span class="math inline">\(X_i\)</span> with <span class="math inline">\(\mu_y\)</span> is the same, regardless of the value of <span class="math inline">\(X_j\)</span> (<span class="math inline">\(j \neq i\)</span>).</p>
</blockquote>
<p>This states that the relationship between the various predictors <span class="math inline">\(X_j\)</span> and the <em>conditional mean</em> (<span class="math inline">\(\mathbb{E}[Y|X]\)</span>) is linear while the other variables are held constant, and additive.</p>
<section id="common-misconceptions-re-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="common-misconceptions-re-assumptions">Common Misconceptions re: assumptions</h2>
<section id="x-and-y-dont-have-to-be-normally-distributed" class="level4">
<h4 class="anchored" data-anchor-id="x-and-y-dont-have-to-be-normally-distributed">X and Y don’t have to be normally distributed</h4>
<p>From <a href="http://dx.doi.org/10.7717/peerj.3323">Ernst and Albers 2017</a>:</p>
<blockquote class="blockquote">
<p>Most commonly, researchers incorrectly assume that X, or both X and Y, should be normally distributed, rather than the errors of the model.</p>
</blockquote>
<p>They use the example of an independent [[t-test]]. Assume we are given two population distributions that are independent from each other (e.g.&nbsp;one distribution representing a treatment group, the other a control group), are normally distributed and have equal variance, and we want to compute a t-statistic. This can be done using a regression model where <span class="math inline">\(X\)</span> is a dummy variable that encodes each group, yielding a conditional mean for each group once the model is fit, <span class="math inline">\(\mathbb{E}[Y \mid X]\)</span>. It’s clear that <span class="math inline">\(X\)</span> is not normally distributed since it only takes on two values in this case:</p>
<blockquote class="blockquote">
<p>This resulting ‘conditional membership’ distribution is nothing close to normal (as it takes on just two values), however no assumption of the general linear model is violated because ==the subpopulations of Y for each of the X values follow a normal distibution with equal variances.</p>
</blockquote>
</section>
<section id="non-linear-relationships-can-be-modeled-using-ols-regression" class="level4">
<h4 class="anchored" data-anchor-id="non-linear-relationships-can-be-modeled-using-ols-regression">Non-linear relationships <em>can</em> be modeled using OLS regression</h4>
<p>The linearity assumption only deals with ==linearity in the parameters and the estimates== (e.g.&nbsp;<span class="math inline">\(\beta_j\)</span>), but not necessarily in the variables. For example, polynomial regression models have polynomial variables like <span class="math inline">\(X_{ji}\)</span> and <span class="math inline">\(X_{ji}^{2}\)</span>.</p>
</section>
</section>
</section>
<section id="uses" class="level1">
<h1>Uses</h1>
<p>Linear regression can answer questions like:</p>
<ol type="1">
<li>Is there an association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>?</li>
<li>How strong is the relationship?</li>
<li>If <span class="math inline">\(X\)</span> is multiclass, which class is associated with <span class="math inline">\(Y\)</span>, and how large are the effects?</li>
<li>How accurately can we predict <span class="math inline">\(Y\)</span> from <span class="math inline">\(X\)</span>?</li>
<li>Is the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> linear?</li>
<li>Is there an interaction effect between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>?</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>