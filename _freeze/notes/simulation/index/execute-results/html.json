{
  "hash": "54dac9c290eaf9de764f3e00da629b84",
  "result": {
    "markdown": "---\ntitle: \"Using Simulation to Understand Statistics\"\neditor: visual\n---\n\n# Motivation\n\nStatistics in the 21st century should be learned using computers. Specifically, simulations can be used to understand statistical concepts through play and tinkering (the best way to learn!).\n\nWhat follows are notes and examples I played with from the book [Learning Statistical Models Through Simulation in R](https://psyteachr.github.io/stat-models-v1/introduction.html).\n\n# Introduction\n\nSimulation inverts the process of sampling from a population and estimating parameters. We instead fix a model and set its correspond\n\n## Simulating Reaction Times\n\nWe assume that mean reaction time is normally distributed with a mean of $480$ and SD of $40$ for the parents with toddlers, whereas the parents without toddlers are assumed to have mean reaction times from a normal distribution with a mean of $500$ and SD of $40$.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.5     ✔ purrr   0.3.4\n✔ tibble  3.1.6     ✔ dplyr   1.0.8\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nset.seed(2021)\n\ntodds <- rnorm(n=50, mean=480, sd=40)\ncontrols <- rnorm(n=50, mean=500, sd=40)\n\ndf <- tibble(groups = rep(c(\"todd\", \"control\"), each=50),\n             rt = c(todds, controls)) %>%\n  # compute z-scores\n  mutate(z_rt = (rt-mean(rt))/sd(rt))\n```\n:::\n\nLet's plot the data:\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x=z_rt, fill=groups)) +\n  geom_density(alpha=0.5) +\n  labs(title=\"Z-Score Reaction Times for Controls versus Parents with Toddlers\",\n       x=\"Z-score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\nLet's compare the mean and standard deviations from our simulated samples now. Are they different from the population parameters we set?\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  group_by(groups) %>%\n  summarize(mean_rt = mean(rt),\n            sd_rt = sd(rt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 3\n  groups  mean_rt sd_rt\n  <chr>     <dbl> <dbl>\n1 control    485.  35.3\n2 todd       481.  45.3\n```\n:::\n:::\nLet's run a t-test too:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(df$rt ~ df$groups)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  df$rt by df$groups\nt = 0.5871, df = 92.511, p-value = 0.5586\nalternative hypothesis: true difference in means between group control and group todd is not equal to 0\n95 percent confidence interval:\n -11.36773  20.91001\nsample estimates:\nmean in group control    mean in group todd \n             485.4062              480.6351 \n```\n:::\n:::\n\n\nWe see that with group sizes of 50, the estimated parameters are slightly off from the population parameters. We can improve this by increasing the sample size.\n\n::: {.cell}\n\n```{.r .cell-code}\ngroup_size <- 1000\n\ntodds <- rnorm(n=group_size, mean=480, sd=40)\ncontrols <- rnorm(n=group_size, mean=500, sd=40)\n\ndf <- tibble(groups = rep(c(\"todd\", \"control\"), each=group_size),\n             rt = c(todds, controls)) %>%\n  # compute z-scores\n  mutate(z_rt = (rt-mean(rt))/sd(rt))\n\ndf %>%\n  ggplot(aes(x=z_rt, fill=groups)) +\n  geom_density(alpha=0.5) +\n  labs(title=\"Z-Score Reaction Times for Controls versus Parents with Toddlers (n=2000)\",\n       x=\"Z-score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\nNow the estimates are closer to the true population value, though still not quite perfect!\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  group_by(groups) %>%\n  summarize(mean_rt = mean(rt),\n            sd_rt = sd(rt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 3\n  groups  mean_rt sd_rt\n  <chr>     <dbl> <dbl>\n1 control    502.  40.3\n2 todd       481.  41.0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(df$rt ~ df$groups)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  df$rt by df$groups\nt = 11.679, df = 1997.5, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group control and group todd is not equal to 0\n95 percent confidence interval:\n 17.67332 24.80684\nsample estimates:\nmean in group control    mean in group todd \n             502.0352              480.7951 \n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}